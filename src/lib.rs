use sha2::{Digest, Sha256, Sha512};

static EMOJIS_LENGTH: u16 = 333;

static EMOJIS: [&str; 333] = [
    "ğŸ˜‰", "ğŸ˜", "ğŸ˜›", "ğŸ˜­", "ğŸ˜±", "ğŸ˜¡", "ğŸ˜", "ğŸ˜´", "ğŸ˜µ", "ğŸ˜ˆ", "ğŸ˜¬", "ğŸ˜‡", "ğŸ˜", "ğŸ‘®", "ğŸ‘·", "ğŸ’‚",
    "ğŸ‘¶", "ğŸ‘¨", "ğŸ‘©", "ğŸ‘´", "ğŸ‘µ", "ğŸ˜»", "ğŸ˜½", "ğŸ™€", "ğŸ‘º", "ğŸ™ˆ", "ğŸ™‰", "ğŸ™Š", "ğŸ’€", "ğŸ‘½", "ğŸ’©", "ğŸ”¥",
    "ğŸ’¥", "ğŸ’¤", "ğŸ‘‚", "ğŸ‘€", "ğŸ‘ƒ", "ğŸ‘…", "ğŸ‘„", "ğŸ‘", "ğŸ‘", "ğŸ‘Œ", "ğŸ‘Š", "âœŒ", "âœ‹", "ğŸ‘", "ğŸ‘†", "ğŸ‘‡",
    "ğŸ‘‰", "ğŸ‘ˆ", "ğŸ™", "ğŸ‘", "ğŸ’ª", "ğŸš¶", "ğŸƒ", "ğŸ’ƒ", "ğŸ‘«", "ğŸ‘ª", "ğŸ‘¬", "ğŸ‘­", "ğŸ’…", "ğŸ©", "ğŸ‘‘", "ğŸ‘’",
    "ğŸ‘Ÿ", "ğŸ‘", "ğŸ‘ ", "ğŸ‘•", "ğŸ‘—", "ğŸ‘–", "ğŸ‘™", "ğŸ‘œ", "ğŸ‘“", "ğŸ€", "ğŸ’„", "ğŸ’›", "ğŸ’™", "ğŸ’œ", "ğŸ’š", "ğŸ’",
    "ğŸ’", "ğŸ¶", "ğŸº", "ğŸ±", "ğŸ­", "ğŸ¹", "ğŸ°", "ğŸ¸", "ğŸ¯", "ğŸ¨", "ğŸ»", "ğŸ·", "ğŸ®", "ğŸ—", "ğŸ´", "ğŸ‘",
    "ğŸ˜", "ğŸ¼", "ğŸ§", "ğŸ¥", "ğŸ”", "ğŸ", "ğŸ¢", "ğŸ›", "ğŸ", "ğŸœ", "ğŸ", "ğŸŒ", "ğŸ™", "ğŸš", "ğŸŸ", "ğŸ¬",
    "ğŸ‹", "ğŸ", "ğŸŠ", "ğŸ«", "ğŸ€", "ğŸŒ¹", "ğŸŒ»", "ğŸ", "ğŸŒ¾", "ğŸ„", "ğŸŒµ", "ğŸŒ´", "ğŸŒ³", "ğŸŒ", "ğŸŒš", "ğŸŒ™",
    "ğŸŒ", "ğŸŒ‹", "âš¡", "â˜”", "â„", "â›„", "ğŸŒ€", "ğŸŒˆ", "ğŸŒŠ", "ğŸ“", "ğŸ†", "ğŸƒ", "ğŸ‘»", "ğŸ…", "ğŸ„", "ğŸ",
    "ğŸˆ", "ğŸ”®", "ğŸ¥", "ğŸ“·", "ğŸ’¿", "ğŸ’»", "â˜", "ğŸ“¡", "ğŸ“º", "ğŸ“»", "ğŸ”‰", "ğŸ””", "â³", "â°", "âŒš", "ğŸ”’",
    "ğŸ”‘", "ğŸ”", "ğŸ’¡", "ğŸ”¦", "ğŸ”Œ", "ğŸ”‹", "ğŸš¿", "ğŸš½", "ğŸ”§", "ğŸ”¨", "ğŸšª", "ğŸš¬", "ğŸ’£", "ğŸ”«", "ğŸ”ª", "ğŸ’Š",
    "ğŸ’‰", "ğŸ’°", "ğŸ’µ", "ğŸ’³", "âœ‰", "ğŸ“«", "ğŸ“¦", "ğŸ“…", "ğŸ“", "âœ‚", "ğŸ“Œ", "ğŸ“", "âœ’", "âœ", "ğŸ“", "ğŸ“š",
    "ğŸ”¬", "ğŸ”­", "ğŸ¨", "ğŸ¬", "ğŸ¤", "ğŸ§", "ğŸµ", "ğŸ¹", "ğŸ»", "ğŸº", "ğŸ¸", "ğŸ‘¾", "ğŸ®", "ğŸƒ", "ğŸ²", "ğŸ¯",
    "ğŸˆ", "ğŸ€", "âš½", "âš¾", "ğŸ¾", "ğŸ±", "ğŸ‰", "ğŸ³", "ğŸ", "ğŸ‡", "ğŸ†", "ğŸŠ", "ğŸ„", "â˜•", "ğŸ¼", "ğŸº",
    "ğŸ·", "ğŸ´", "ğŸ•", "ğŸ”", "ğŸŸ", "ğŸ—", "ğŸ±", "ğŸš", "ğŸœ", "ğŸ¡", "ğŸ³", "ğŸ", "ğŸ©", "ğŸ¦", "ğŸ‚", "ğŸ°",
    "ğŸª", "ğŸ«", "ğŸ­", "ğŸ¯", "ğŸ", "ğŸ", "ğŸŠ", "ğŸ‹", "ğŸ’", "ğŸ‡", "ğŸ‰", "ğŸ“", "ğŸ‘", "ğŸŒ", "ğŸ", "ğŸ",
    "ğŸ†", "ğŸ…", "ğŸŒ½", "ğŸ¡", "ğŸ¥", "ğŸ¦", "â›ª", "ğŸ°", "â›º", "ğŸ­", "ğŸ—»", "ğŸ—½", "ğŸ ", "ğŸ¡", "â›²", "ğŸ¢",
    "ğŸš¢", "ğŸš¤", "âš“", "ğŸš€", "âœˆ", "ğŸš", "ğŸš‚", "ğŸš‹", "ğŸš", "ğŸšŒ", "ğŸš™", "ğŸš—", "ğŸš•", "ğŸš›", "ğŸš¨", "ğŸš”",
    "ğŸš’", "ğŸš‘", "ğŸš²", "ğŸš ", "ğŸšœ", "ğŸš¦", "âš ", "ğŸš§", "â›½", "ğŸ°", "ğŸ—¿", "ğŸª", "ğŸ­", "ğŸ‡¯ğŸ‡µ", "ğŸ‡°ğŸ‡·", "ğŸ‡©ğŸ‡ª",
    "ğŸ‡¨ğŸ‡³", "ğŸ‡ºğŸ‡¸", "ğŸ‡«ğŸ‡·", "ğŸ‡ªğŸ‡¸", "ğŸ‡®ğŸ‡¹", "ğŸ‡·ğŸ‡º", "ğŸ‡¬ğŸ‡§", "1âƒ£", "2âƒ£", "3âƒ£", "4âƒ£", "5âƒ£", "6âƒ£", "7âƒ£", "8âƒ£", "9âƒ£", "0âƒ£",
    "ğŸ”Ÿ", "â—", "â“", "â™¥", "â™¦", "ğŸ’¯", "ğŸ”—", "ğŸ”±", "ğŸ”´", "ğŸ”µ", "ğŸ”¶", "ğŸ”·",
];

pub fn sha256(msg: &Vec<u8>) -> Vec<u8> {
    let mut hasher = Sha256::new();
    hasher.update(msg);
    let result = hasher.finalize();
    result.to_vec()
}

pub fn sha512(msg: &Vec<u8>) -> Vec<u8> {
    let mut hasher = Sha512::new();
    hasher.update(msg);
    let result = hasher.finalize();
    result.to_vec()
}

fn bytes_to_long(arr: &[u8], offset: usize) -> i128 {
    (((arr[offset] as i128) & 0x7F) << 56) as i128
        | (((arr[offset + 1] as i128) & 0xFF) << 48) as i128
        | (((arr[offset + 2] as i128) & 0xFF) << 40) as i128
        | (((arr[offset + 3] as i128) & 0xFF) << 32) as i128
        | (((arr[offset + 4] as i128) & 0xFF) << 24) as i128
        | (((arr[offset + 5] as i128) & 0xFF) << 16) as i128
        | (((arr[offset + 6] as i128) & 0xFF) << 8) as i128
        | ((arr[offset + 7] as i128) & 0xFF)
}

pub fn emojify(key: &[u8]) -> Vec<&str> {
    let mut emojified_key = Vec::new();
    for i in 0..4 {
        let index: u16 = (bytes_to_long(key, 8 * i) % (EMOJIS_LENGTH as i128)) as u16;
        emojified_key.push(EMOJIS[index as usize]);
    }

    emojified_key
}

pub fn print_emojified_key(emojified_key: &[&str]) {
    for x in emojified_key.iter().take(4) {
        print!("{}", x);
    }
    println!();
}
